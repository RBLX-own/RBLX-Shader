--// Enhanced GUI Script with Modern Features
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local ContentProvider = game:GetService("ContentProvider")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")

-- Main GUI
local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Name = "EnhancedGUI"
gui.IgnoreGuiInset = true
gui.Parent = player:WaitForChild("PlayerGui")

-- Storage for assets
local assetCache = {}

----------------------------------------------------
-- 1️⃣ LOAD AND DISPLAY SMALL MOVABLE ICON
----------------------------------------------------
local function createMovableIcon()
	-- Download and cache the image
	local imageUrl = "https://drive.google.com/uc?export=download&id=1sFBzKFh-XqUg21-IgqRFz3IrNtK8tA_b"
	
	-- Create a loading indicator while image loads
	local loadingFrame = Instance.new("Frame")
	loadingFrame.Size = UDim2.new(0, 60, 0, 60)
	loadingFrame.Position = UDim2.new(0, 20, 0, 20)
	loadingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	loadingFrame.BackgroundTransparency = 0.2
	loadingFrame.Active = true
	loadingFrame.Draggable = true
	loadingFrame.Parent = gui
	
	local uiCorner = Instance.new("UICorner", loadingFrame)
	uiCorner.CornerRadius = UDim.new(0, 20)
	
	local loadingText = Instance.new("TextLabel")
	loadingText.Size = UDim2.new(1, 0, 1, 0)
	loadingText.Text = "Loading..."
	loadingText.TextColor3 = Color3.fromRGB(200, 200, 200)
	loadingText.BackgroundTransparency = 1
	loadingText.Font = Enum.Font.Gotham
	loadingText.TextSize = 12
	loadingText.Parent = loadingFrame
	
	-- Add subtle pulsing animation
	local pulseConnection
	pulseConnection = RunService.Heartbeat:Connect(function()
		local alpha = (math.sin(tick() * 4) + 1) / 2 * 0.3 + 0.2
		loadingFrame.BackgroundTransparency = alpha
	end)
	
	-- Asynchronously load the image
	task.spawn(function()
		local success, result = pcall(function()
			return game:HttpGetAsync(imageUrl)
		end)
		
		pulseConnection:Disconnect()
		loadingFrame:Destroy()
		
		if success and result then
			-- Create the actual icon
			local iconFrame = Instance.new("Frame")
			iconFrame.Size = UDim2.new(0, 60, 0, 60)
			iconFrame.Position = UDim2.new(0, 20, 0, 20)
			iconFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
			iconFrame.BackgroundTransparency = 0.1
			iconFrame.Active = true
			iconFrame.Draggable = true
			iconFrame.Parent = gui
			iconFrame.Name = "MovableIcon"
			
			-- Create squircle shape (rounded rectangle)
			local uiCorner = Instance.new("UICorner", iconFrame)
			uiCorner.CornerRadius = UDim.new(0, 18) -- More rounded corners
			
			-- Add stroke
			local uiStroke = Instance.new("UIStroke", iconFrame)
			uiStroke.Color = Color3.fromRGB(100, 100, 255)
			uiStroke.Thickness = 1.5
			uiStroke.Transparency = 0.3
			
			-- Add shadow
			local shadow = Instance.new("ImageLabel", iconFrame)
			shadow.Size = UDim2.new(1, 0, 1, 0)
			shadow.BackgroundTransparency = 1
			shadow.Image = "rbxassetid://1316045217" -- Soft shadow
			shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
			shadow.ImageTransparency = 0.8
			shadow.ScaleType = Enum.ScaleType.Slice
			shadow.SliceCenter = Rect.new(10, 10, 118, 118)
			shadow.SliceScale = 0.2
			
			-- Add image
			local imageLabel = Instance.new("ImageLabel", iconFrame)
			imageLabel.Size = UDim2.new(0.8, 0, 0.8, 0)
			imageLabel.Position = UDim2.new(0.1, 0, 0.1, 0)
			imageLabel.BackgroundTransparency = 1
			imageLabel.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png" -- Placeholder
			imageLabel.ScaleType = Enum.ScaleType.Fit
			
			-- Try to set the actual image
			pcall(function()
				-- For security, Roblox doesn't allow direct external image loading
				-- In a real scenario, you'd need to use Roblox Asset IDs
				-- This is a workaround using a placeholder with custom graphics
				
				-- Create a decorative placeholder
				local gradient = Instance.new("UIGradient", imageLabel)
				gradient.Color = ColorSequence.new({
					ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 150, 255)),
					ColorSequenceKeypoint.new(1, Color3.fromRGB(200, 100, 255))
				})
				gradient.Rotation = 45
				
				-- Add icon symbol
				local iconText = Instance.new("TextLabel", imageLabel)
				iconText.Size = UDim2.new(1, 0, 1, 0)
				iconText.Text = "✨"
				iconText.Font = Enum.Font.GothamBold
				iconText.TextSize = 24
				iconText.TextColor3 = Color3.fromRGB(255, 255, 255)
				iconText.BackgroundTransparency = 1
				iconText.TextTransparency = 0.2
			end)
			
			-- Add hover effects
			local isHovering = false
			iconFrame.MouseEnter:Connect(function()
				isHovering = true
				TweenService:Create(iconFrame, TweenInfo.new(0.2), {
					Size = UDim2.new(0, 65, 0, 65),
					BackgroundTransparency = 0
				}):Play()
				TweenService:Create(uiStroke, TweenInfo.new(0.2), {
					Thickness = 2.5,
					Transparency = 0.1
				}):Play()
			end)
			
			iconFrame.MouseLeave:Connect(function()
				isHovering = false
				TweenService:Create(iconFrame, TweenInfo.new(0.2), {
					Size = UDim2.new(0, 60, 0, 60),
					BackgroundTransparency = 0.1
				}):Play()
				TweenService:Create(uiStroke, TweenInfo.new(0.2), {
					Thickness = 1.5,
					Transparency = 0.3
				}):Play()
			end)
			
			-- Click handler to open main GUI
			iconFrame.InputBegan:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 then
					TweenService:Create(iconFrame, TweenInfo.new(0.1), {
						Size = UDim2.new(0, 55, 0, 55)
					}):Play()
					task.wait(0.1)
					TweenService:Create(iconFrame, TweenInfo.new(0.1), {
						Size = UDim2.new(0, 60, 0, 60)
					}):Play()
					
					-- Only show popup if it hasn't been shown before
					if not _G.popupShown then
						_G.popupShown = true
						createTelegramPopup()
					end
				end
			end)
			
			-- Add smooth dragging
			local dragInput, dragStart, startPos
			local dragging = false
			
			local function update(input)
				local delta = input.Position - dragStart
				iconFrame.Position = UDim2.new(
					startPos.X.Scale,
					startPos.X.Offset + delta.X,
					startPos.Y.Scale,
					startPos.Y.Offset + delta.Y
				)
			end
			
			iconFrame.InputBegan:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 then
					dragging = true
					dragStart = input.Position
					startPos = iconFrame.Position
					
					input.Changed:Connect(function()
						if input.UserInputState == Enum.UserInputState.End then
							dragging = false
						end
					end)
				end
			end)
			
			iconFrame.InputChanged:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseMovement and dragging then
					dragInput = input
				end
			end)
			
			UserInputService.InputChanged:Connect(function(input)
				if input == dragInput and dragging then
					update(input)
				end
			end)
			
			-- Add auto-snap to screen edges
			iconFrame.Changed:Connect(function()
				if not dragging then
					local viewportSize = workspace.CurrentCamera.ViewportSize
					local pos = iconFrame.AbsolutePosition
					local size = iconFrame.AbsoluteSize
					
					if pos.X < 0 then
						iconFrame.Position = UDim2.new(0, 10, iconFrame.Position.Y.Scale, iconFrame.Position.Y.Offset)
					elseif pos.X + size.X > viewportSize.X then
						iconFrame.Position = UDim2.new(
							1, -(size.X + 10),
							iconFrame.Position.Y.Scale,
							iconFrame.Position.Y.Offset
						)
					end
					
					if pos.Y < 0 then
						iconFrame.Position = UDim2.new(iconFrame.Position.X.Scale, iconFrame.Position.X.Offset, 0, 10)
					elseif pos.Y + size.Y > viewportSize.Y then
						iconFrame.Position = UDim2.new(
							iconFrame.Position.X.Scale,
							iconFrame.Position.X.Offset,
							1, -(size.Y + 10)
						)
					end
				end
			end)
			
			-- Add subtle floating animation
			task.spawn(function()
				while iconFrame and iconFrame.Parent do
					if not dragging and not isHovering then
						local offset = Vector2.new(
							math.sin(tick() * 0.5) * 1,
							math.sin(tick() * 0.5 + 1) * 1
						)
						iconFrame.Position = iconFrame.Position + UDim2.new(0, offset.X, 0, offset.Y)
					end
					task.wait(0.05)
				end
			end)
		else
			warn("Failed to load icon image")
		end
	end)
end

----------------------------------------------------
-- 2️⃣ TELEGRAM POPUP WITH BACKGROUND IMAGE
----------------------------------------------------
local function createTelegramPopup()
	-- Check if popup should be shown
	if _G.popupShown and _G.telegramClicked then
		createMainGUI()
		return
	end
	
	-- Create overlay background
	local overlay = Instance.new("Frame", gui)
	overlay.Size = UDim2.new(1, 0, 1, 0)
	overlay.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
	overlay.BackgroundTransparency = 0.5
	overlay.ZIndex = 5
	overlay.Name = "Overlay"
	
	-- Main popup container
	local popup = Instance.new("Frame", overlay)
	popup.Size = UDim2.new(0, 0, 0, 0)
	popup.Position = UDim2.new(0.5, 0, 0.5, 0)
	popup.AnchorPoint = Vector2.new(0.5, 0.5)
	popup.BackgroundTransparency = 1
	popup.ZIndex = 6
	
	-- Background image
	local background = Instance.new("ImageLabel", popup)
	background.Size = UDim2.new(1, 0, 1, 0)
	background.Image = "rbxassetid://1234567890" -- You'll need a valid Roblox asset ID
	background.ScaleType = Enum.ScaleType.Crop
	background.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
	
	-- Create gradient overlay
	local gradient = Instance.new("UIGradient", background)
	gradient.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(15, 15, 25)),
		ColorSequenceKeypoint.new(0.5, Color3.fromRGB(15, 15, 25, 0.7)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
	})
	
	local uiCorner = Instance.new("UICorner", background)
	uiCorner.CornerRadius = UDim.new(0, 24)
	
	-- Content container
	local content = Instance.new("Frame", popup)
	content.Size = UDim2.new(1, -40, 1, -40)
	content.Position = UDim2.new(0, 20, 0, 20)
	content.BackgroundTransparency = 1
	content.ZIndex = 7
	
	-- Animate popup opening
	popup:TweenSize(UDim2.new(0, 400, 0, 300), Enum.EasingDirection.Out, Enum.EasingStyle.Back, 0.6, true)
	
	-- Title with modern font
	local title = Instance.new("TextLabel", content)
	title.Size = UDim2.new(1, 0, 0, 60)
	title.BackgroundTransparency = 1
	title.Text = "Join Our Community"
	title.Font = Enum.Font.GothamSemibold
	title.TextSize = 28
	title.TextColor3 = Color3.fromRGB(255, 255, 255)
	title.TextTransparency = 0
	title.ZIndex = 8
	
	-- Description
	local description = Instance.new("TextLabel", content)
	description.Size = UDim2.new(1, 0, 0, 60)
	description.Position = UDim2.new(0, 0, 0, 70)
	description.BackgroundTransparency = 1
	description.Text = "Get exclusive scripts, updates, and community support"
	description.Font = Enum.Font.Gotham
	description.TextSize = 16
	description.TextColor3 = Color3.fromRGB(200, 200, 220)
	description.TextWrapped = true
	description.ZIndex = 8
	
	-- Telegram link button with modern design
	local telegramBtn = Instance.new("TextButton", content)
	telegramBtn.Size = UDim2.new(1, 0, 0, 55)
	telegramBtn.Position = UDim2.new(0, 0, 0, 150)
	telegramBtn.BackgroundColor3 = Color3.fromRGB(34, 158, 217) -- Telegram blue
	telegramBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
	telegramBtn.Text = "Join Telegram Group"
	telegramBtn.Font = Enum.Font.GothamSemibold
	telegramBtn.TextSize = 18
	telegramBtn.ZIndex = 8
	
	local btnCorner = Instance.new("UICorner", telegramBtn)
	btnCorner.CornerRadius = UDim.new(0, 12)
	
	local btnStroke = Instance.new("UIStroke", telegramBtn)
	btnStroke.Color = Color3.fromRGB(255, 255, 255)
	btnStroke.Thickness = 1.5
	btnStroke.Transparency = 0.5
	
	-- Add telegram icon
	local icon = Instance.new("TextLabel", telegramBtn)
	icon.Size = UDim2.new(0, 30, 0, 30)
	icon.Position = UDim2.new(0, 20, 0.5, -15)
	icon.Text = "✈️"
	icon.Font = Enum.Font.GothamBold
	icon.TextSize = 20
	icon.BackgroundTransparency = 1
	icon.TextColor3 = Color3.fromRGB(255, 255, 255)
	icon.ZIndex = 9
	
	-- Continue without joining button
	local continueBtn = Instance.new("TextButton", content)
	continueBtn.Size = UDim2.new(1, 0, 0, 45)
	continueBtn.Position = UDim2.new(0, 0, 0, 220)
	continueBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
	continueBtn.TextColor3 = Color3.fromRGB(180, 180, 200)
	continueBtn.Text = "Continue Without Joining"
	continueBtn.Font = Enum.Font.Gotham
	continueBtn.TextSize = 14
	continueBtn.ZIndex = 8
	
	local continueCorner = Instance.new("UICorner", continueBtn)
	continueCorner.CornerRadius = UDim.new(0, 10)
	
	-- Hover effects
	telegramBtn.MouseEnter:Connect(function()
		TweenService:Create(telegramBtn, TweenInfo.new(0.2), {
			BackgroundColor3 = Color3.fromRGB(40, 175, 240),
			Size = UDim2.new(1, 5, 0, 58)
		}):Play()
	end)
	
	telegramBtn.MouseLeave:Connect(function()
		TweenService:Create(telegramBtn, TweenInfo.new(0.2), {
			BackgroundColor3 = Color3.fromRGB(34, 158, 217),
			Size = UDim2.new(1, 0, 0, 55)
		}):Play()
	end)
	
	-- Button handlers
	telegramBtn.MouseButton1Click:Connect(function()
		_G.telegramClicked = true
		
		-- Open in browser
		local url = "https://t.me/RBLX_SCRIPTS_MYANMAR"
		pcall(function()
			if request then
				request({
					Url = "http://localhost:6463/rpc?v=1",
					Method = "POST",
					Headers = {
						["Content-Type"] = "application/json",
						["Origin"] = "https://discord.com"
					},
					Body = game:GetService("HttpService"):JSONEncode({
						cmd = "INVITE_BROWSER",
						args = {code = url},
						nonce = game:GetService("HttpService"):GenerateGUID(false)
					})
				})
			end
		end)
		
		-- Try clipboard as fallback
		pcall(function()
			if setclipboard then
				setclipboard(url)
			elseif writeclipboard then
				writeclipboard(url)
			end
			telegramBtn.Text = "Link Copied!"
		end)
		
		-- Close popup and open main GUI
		popup:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.In, Enum.EasingStyle.Back, 0.4, true)
		overlay:TweenSizeAndPosition(
			UDim2.new(0, 0, 0, 0),
			UDim2.new(0.5, 0, 0.5, 0),
			Enum.EasingDirection.In,
			Enum.EasingStyle.Back,
			0.4,
			true
		)
		task.wait(0.4)
		popup:Destroy()
		overlay:Destroy()
		
		createMainGUI()
	end)
	
	continueBtn.MouseButton1Click:Connect(function()
		_G.telegramClicked = false
		popup:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.In, Enum.EasingStyle.Back, 0.4, true)
		overlay:TweenSizeAndPosition(
			UDim2.new(0, 0, 0, 0),
			UDim2.new(0.5, 0, 0.5, 0),
			Enum.EasingDirection.In,
			Enum.EasingStyle.Back,
			0.4,
			true
		)
		task.wait(0.4)
		popup:Destroy()
		overlay:Destroy()
		
		createMainGUI()
	end)
end

----------------------------------------------------
-- 3️⃣ MAIN ENHANCER GUI
----------------------------------------------------
local function createMainGUI()
	local frame = Instance.new("Frame", gui)
	frame.Size = UDim2.new(0, 300, 0, 220)
	frame.Position = UDim2.new(0.5, 0, 0.5, 0)
	frame.AnchorPoint = Vector2.new(0.5, 0.5)
	frame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
	frame.Active = true
	frame.Draggable = true
	frame.BorderSizePixel = 0
	frame.Name = "EnhancerGUI"
	
	local uiCorner = Instance.new("UICorner", frame)
	uiCorner.CornerRadius = UDim.new(0, 20)
	
	local uiStroke = Instance.new("UIStroke", frame)
	uiStroke.Color = Color3.fromRGB(60, 60, 80)
	uiStroke.Thickness = 2
	
	-- Add shadow
	local shadow = Instance.new("ImageLabel", frame)
	shadow.Size = UDim2.new(1, 20, 1, 20)
	shadow.Position = UDim2.new(0, -10, 0, -10)
	shadow.Image = "rbxassetid://1316045217"
	shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
	shadow.ImageTransparency = 0.8
	shadow.ScaleType = Enum.ScaleType.Slice
	shadow.SliceCenter = Rect.new(10, 10, 118, 118)
	shadow.BackgroundTransparency = 1
	shadow.ZIndex = -1
	
	-- Animate opening
	frame:TweenSize(UDim2.new(0, 320, 0, 240), Enum.EasingDirection.Out, Enum.EasingStyle.Back, 0.5, true)
	
	-- Title bar
	local titleBar = Instance.new("Frame", frame)
	titleBar.Size = UDim2.new(1, 0, 0, 40)
	titleBar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
	titleBar.BorderSizePixel = 0
	
	local titleCorner = Instance.new("UICorner", titleBar)
	titleCorner.CornerRadius = UDim.new(0, 20, 0, 0)
	
	local title = Instance.new("TextLabel", titleBar)
	title.Size = UDim2.new(1, -40, 1, 0)
	title.Position = UDim2.new(0, 10, 0, 0)
	title.BackgroundTransparency = 1
	title.Text = "Game Enhancer v2.0"
	title.Font = Enum.Font.GothamSemibold
	title.TextSize = 18
	title.TextColor3 = Color3.fromRGB(220, 220, 255)
	title.TextXAlignment = Enum.TextXAlignment.Left
	
	-- Close button
	local closeBtn = Instance.new("TextButton", titleBar)
	closeBtn.Size = UDim2.new(0, 30, 0, 30)
	closeBtn.Position = UDim2.new(1, -35, 0.5, -15)
	closeBtn.Text = "✕"
	closeBtn.Font = Enum.Font.GothamBold
	closeBtn.TextSize = 16
	closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
	closeBtn.BackgroundTransparency = 1
	
	closeBtn.MouseButton1Click:Connect(function()
		frame:TweenSize(UDim2.new(0, 0, 0, 0), Enum.EasingDirection.In, Enum.EasingStyle.Back, 0.3, true)
		task.wait(0.3)
		frame:Destroy()
	end)
	
	-- Content area
	local content = Instance.new("Frame", frame)
	content.Size = UDim2.new(1, -20, 1, -60)
	content.Position = UDim2.new(0, 10, 0, 50)
	content.BackgroundTransparency = 1
	
	----------------------------------------------------
	-- SHADER TOGGLE BUTTON
	----------------------------------------------------
	local shaderEnabled = false
	local shaderEffects = {}
	
	local shaderBtn = Instance.new("TextButton", content)
	shaderBtn.Size = UDim2.new(1, 0, 0, 50)
	shaderBtn.Position = UDim2.new(0, 0, 0, 0)
	shaderBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
	shaderBtn.TextColor3 = Color3.fromRGB(220, 220, 255)
	shaderBtn.Font = Enum.Font.GothamSemibold
	shaderBtn.TextSize = 16
	shaderBtn.Text = "Enable Shader"
	
	local shaderCorner = Instance.new("UICorner", shaderBtn)
	shaderCorner.CornerRadius = UDim.new(0, 12)
	
	local shaderStroke = Instance.new("UIStroke", shaderBtn)
	shaderStroke.Color = Color3.fromRGB(80, 120, 255)
	shaderStroke.Thickness = 2
	
	-- Shader status indicator
	local shaderIndicator = Instance.new("Frame", shaderBtn)
	shaderIndicator.Size = UDim2.new(0, 10, 0, 10)
	shaderIndicator.Position = UDim2.new(1, -25, 0.5, -5)
	shaderIndicator.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
	
	local indicatorCorner = Instance.new("UICorner", shaderIndicator)
	indicatorCorner.CornerRadius = UDim.new(1, 0)
	
	local function toggleShader()
		if not shaderEnabled then
			-- Enable shader (same as before but optimized)
			local lighting = game.Lighting
			
			-- Store original values
			shaderEffects.originals = {
				Ambient = lighting.Ambient,
				Brightness = lighting.Brightness,
				ClockTime = lighting.ClockTime
			}
			
			-- Apply enhanced shader
			lighting.Ambient = Color3.fromRGB(25, 28, 35)
			lighting.Brightness = 1.8
			lighting.ColorShift_Bottom = Color3.fromRGB(8, 10, 15)
			lighting.ColorShift_Top = Color3.fromRGB(180, 200, 220)
			lighting.EnvironmentDiffuseScale = 0.6
			lighting.EnvironmentSpecularScale = 0.25
			lighting.GlobalShadows = true
			lighting.ShadowSoftness = 0.08
			lighting.OutdoorAmbient = Color3.fromRGB(90, 105, 125)
			lighting.GeographicLatitude = 45.0
			lighting.ExposureCompensation = 0.15
			lighting.ClockTime = 14
			lighting.ShadowColor = Color3.fromRGB(12, 15, 20)
			
			-- Create effects
			local function createEffect(className, properties)
				local effect = Instance.new(className, lighting)
				for prop, value in pairs(properties) do
					effect[prop] = value
				end
				table.insert(shaderEffects, effect)
				return effect
			end
			
			createEffect("BloomEffect", {
				Intensity = 0.25,
				Size = 32,
				Threshold = 0.9
			})
			
			createEffect("ColorCorrectionEffect", {
				Brightness = 0.05,
				Contrast = 0.35,
				Saturation = 0.1,
				TintColor = Color3.fromRGB(255, 248, 235)
			})
			
			createEffect("DepthOfFieldEffect", {
				FarIntensity = 0.15,
				FocusDistance = 35.0,
				InFocusRadius = 25.0,
				NearIntensity = 0.1
			})
			
			createEffect("Atmosphere", {
				Density = 0.35,
				Offset = 0.5,
				Color = Color3.fromRGB(170, 190, 220),
				Decay = Color3.fromRGB(110, 130, 170),
				Glare = 0.1,
				Haze = 0.15
			})
			
			shaderEnabled = true
			shaderBtn.Text = "Disable Shader"
			TweenService:Create(shaderBtn, TweenInfo.new(0.3), {
				BackgroundColor3 = Color3.fromRGB(60, 100, 180)
			}):Play()
			TweenService:Create(shaderIndicator, TweenInfo.new(0.3), {
				BackgroundColor3 = Color3.fromRGB(50, 255, 100)
			}):Play()
		else
			-- Disable shader
			for _, effect in ipairs(shaderEffects) do
				if effect then
					effect:Destroy()
				end
			end
			shaderEffects = {}
			
			-- Restore original values
			local lighting = game.Lighting
			if shaderEffects.originals then
				for prop, value in pairs(shaderEffects.originals) do
					lighting[prop] = value
				end
			end
			
			shaderEnabled = false
			shaderBtn.Text = "Enable Shader"
			TweenService:Create(shaderBtn, TweenInfo.new(0.3), {
				BackgroundColor3 = Color3.fromRGB(40, 40, 60)
			}):Play()
			TweenService:Create(shaderIndicator, TweenInfo.new(0.3), {
				BackgroundColor3 = Color3.fromRGB(255, 50, 50)
			}):Play()
		end
	end
	
	shaderBtn.MouseButton1Click:Connect(toggleShader)
	
	----------------------------------------------------
	-- FPS BOOST BUTTON
	----------------------------------------------------
	local fpsBtn = Instance.new("TextButton", content)
	fpsBtn.Size = UDim2.new(1, 0, 0, 50)
	fpsBtn.Position = UDim2.new(0, 0, 0, 60)
	fpsBtn.BackgroundColor3 = Color3.fromRGB(50, 60, 80)
	fpsBtn.TextColor3 = Color3.fromRGB(220, 220, 255)
	fpsBtn.Font = Enum.Font.GothamSemibold
	fpsBtn.TextSize = 16
	fpsBtn.Text = "Optimize Performance"
	
	local fpsCorner = Instance.new("UICorner", fpsBtn)
	fpsCorner.CornerRadius = UDim.new(0, 12)
	
	local fpsStroke = Instance.new("UIStroke", fpsBtn)
	fpsStroke.Color = Color3.fromRGB(100, 200, 100)
	fpsStroke.Thickness = 2
	
	fpsBtn.MouseButton1Click:Connect(function()
		-- Optimize performance
		for _, v in pairs(workspace:GetDescendants()) do
			if v:IsA("BasePart") and v.Material ~= Enum.Material.SmoothPlastic then
				v.Material = Enum.Material.SmoothPlastic
			end
			if v:IsA("ParticleEmitter") or v:IsA("Trail") then
				v.Enabled = false
			end
		end
		
		settings().Rendering.QualityLevel = 1
		game.Lighting.GlobalShadows = true
		game.Lighting.FogEnd = 100000
		
		fpsBtn.Text = "Optimized!"
		TweenService:Create(fpsBtn, TweenInfo.new(0.3), {
			BackgroundColor3 = Color3.fromRGB(50, 180, 80)
		}):Play()
		task.wait(1.5)
		fpsBtn.Text = "Optimize Performance"
		TweenService:Create(fpsBtn, TweenInfo.new(0.3), {
			BackgroundColor3 = Color3.fromRGB(50, 60, 80)
		}):Play()
	end)
	
	----------------------------------------------------
	-- FPS COUNTER
	----------------------------------------------------
	local fpsLabel = Instance.new("TextLabel", content)
	fpsLabel.Size = UDim2.new(1, 0, 0, 30)
	fpsLabel.Position = UDim2.new(0, 0, 0, 120)
	fpsLabel.BackgroundTransparency = 1
	fpsLabel.Font = Enum.Font.GothamSemibold
	fpsLabel.TextSize = 14
	fpsLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
	fpsLabel.Text = "FPS: --"
	fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
	
	-- FPS graph
	local graphFrame = Instance.new("Frame", content)
	graphFrame.Size = UDim2.new(1, 0, 0, 20)
	graphFrame.Position = UDim2.new(0, 0, 0, 155)
	graphFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
	
	local graphCorner = Instance.new("UICorner", graphFrame)
	graphCorner.CornerRadius = UDim.new(0, 6)
	
	local graphStroke = Instance.new("UIStroke", graphFrame)
	graphStroke.Color = Color3.fromRGB(60, 60, 80)
	
	-- FPS update loop
	local last = tick()
	local frames = 0
	local fpsHistory = {}
	local maxHistory = 20
	
	RunService.RenderStepped:Connect(function()
		frames += 1
		local now = tick()
		
		if now - last >= 1 then
			local currentFPS = frames
			fpsLabel.Text = string.format("FPS: %d", currentFPS)
			
			-- Color coding
			if currentFPS >= 60 then
				fpsLabel.TextColor3 = Color3.fromRGB(100, 255, 150)
			elseif currentFPS >= 30 then
				fpsLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
			else
				fpsLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
			end
			
			-- Update graph
			table.insert(fpsHistory, currentFPS)
			if #fpsHistory > maxHistory then
				table.remove(fpsHistory, 1)
			end
			
			-- Draw graph bars
			for _, child in ipairs(graphFrame:GetChildren()) do
				if child:IsA("Frame") then
					child:Destroy()
				end
			end
			
			local maxFPS = math.max(unpack(fpsHistory)) or 60
			local barWidth = graphFrame.AbsoluteSize.X / #fpsHistory
			
			for i, fps in ipairs(fpsHistory) do
				local bar = Instance.new("Frame", graphFrame)
				bar.Size = UDim2.new(0, math.max(2, barWidth - 2), 1, 0)
				bar.Position = UDim2.new((i - 1) * barWidth / graphFrame.AbsoluteSize.X, 1, 0, 0)
				bar.BackgroundColor3 = Color3.fromHSV(0.3 * (fps / maxFPS), 0.8, 1)
				bar.BorderSizePixel = 0
				
				local barCorner = Instance.new("UICorner", bar)
				barCorner.CornerRadius = UDim.new(0, 2)
			end
			
			frames = 0
			last = now
		end
	end)
	
	-- Add hover effects for all buttons
	local buttons = {shaderBtn, fpsBtn}
	for _, button in ipairs(buttons) do
		button.MouseEnter:Connect(function()
			TweenService:Create(button, TweenInfo.new(0.2), {
				BackgroundTransparency = 0.1,
				Size = UDim2.new(1, 5, 0, 52)
			}):Play()
		end)
		
		button.MouseLeave:Connect(function()
			TweenService:Create(button, TweenInfo.new(0.2), {
				BackgroundTransparency = 0,
				Size = UDim2.new(1, 0, 0, 50)
			}):Play()
		end)
	end
end

----------------------------------------------------
-- INITIALIZATION
----------------------------------------------------
-- Initialize globals if not exists
_G.popupShown = _G.popupShown or false
_G.telegramClicked = _G.telegramClicked or false

-- Create the movable icon first
createMovableIcon()

-- Show popup only if not shown before
if not _G.popupShown then
	task.wait(1) -- Wait a moment for icon to load
	createTelegramPopup()
else
	-- If popup was already shown, create main GUI directly
	createMainGUI()
end

-- Add auto-save position for icon
game:GetService("UserInputService").WindowFocusReleased:Connect(function()
	-- Save icon position when window loses focus
	local icon = gui:FindFirstChild("MovableIcon")
	if icon then
		_G.iconPosition = {
			X = icon.Position.X.Scale,
			XOffset = icon.Position.X.Offset,
			Y = icon.Position.Y.Scale,
			YOffset = icon.Position.Y.Offset
		}
	end
end)